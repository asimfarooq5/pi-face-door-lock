# Face Recognition / Door Access System

a simple face recognition system using OpenCV and Python, designed to control a GPIO pin on a Raspberry Pi, simulating a door access system. It includes scripts for collecting face data, training a recognition model, and real-time face recognition with GPIO control.

---

## üöÄ Features

- **Dataset Creation**: Capture multiple images of individuals to build a robust dataset for training.
- **Model Training**: Train a Local Binary Patterns Histograms (LBPH) face recognizer model.
- **Real-time Face Recognition**: Identify known individuals from a live camera feed.
- **GPIO Control**: Trigger a GPIO pin upon successful recognition (e.g., to open a door lock, activate an LED).
- **Confidence Thresholding**: Configurable confidence level for recognition.
- **Consecutive Recognition**: Requires multiple consecutive successful recognitions to trigger the GPIO, reducing false positives.

---

## üìÅ Project Structure

```bash
face-recognition-door-access/
‚îú‚îÄ‚îÄ dataset/                  # Stores captured face images, organized by person's name
‚îÇ   ‚îú‚îÄ‚îÄ YourName1/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ YourName1_0.jpg
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ YourName2/
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ dataset_creator.py        # Script to capture face images for the dataset
‚îú‚îÄ‚îÄ model_trainer.py          # Script to train the face recognition model
‚îú‚îÄ‚îÄ face_recognizer.py        # Script for real-time face recognition and GPIO control
‚îú‚îÄ‚îÄ trainer.yml               # Trained face recognition model (generated by model_trainer.py)
‚îú‚îÄ‚îÄ labels.pkl                # Dictionary mapping labels to names (generated by model_trainer.py)
‚îú‚îÄ‚îÄ pyproject.toml            # Project metadata and dependencies
‚îî‚îÄ‚îÄ README.md                 # This README file
```

---

## üõ†Ô∏è Prerequisites

Install the following before you begin:

- Python 3.x
- `opencv-contrib-python`
- `numpy`
- `gpiozero` (Raspberry Pi GPIO control)
- `RPi.GPIO` (dependency for `gpiozero`)

> **Note (for non-Pi development):** You can skip installing GPIO libraries if you're not running on Raspberry Pi.

---

## üì¶ Installation

### 1. Clone the repository

```bash
git clone git@github.com:asimfarooq5/pi-face-door-lock.git
cd face-recognition-door-access/
```

### 2. Create a virtual environment (recommended)

```bash
python3 -m venv venv
source venv/bin/activate  # On Linux/macOS
# venv\Scripts\activate    # On Windows
```

### 3. Install dependencies

```bash
pip install -r requirements.txt
```

---

## ‚ñ∂Ô∏è Usage

### ‚úÖ Step 1: Create Dataset

Run:

```bash
python3 dataset_creator.py
```

- Enter your name when prompted.
- Webcam will open and capture **30 images**.
- Look at the camera and move slightly to capture different angles.
- Images are saved in `dataset/<YourName>/`.

You can repeat this step for different individuals.

---

### ‚úÖ Step 2: Train the Face Recognition Model

Run:

```bash
python3 model_trainer.py
```

- Scans the `dataset/` folder for images.
- Trains an LBPH face recognizer.
- Outputs:
  - `trainer.yml`: Trained model
  - `labels.pkl`: ID-to-name mappings

---

### ‚úÖ Step 3: Run Real-time Face Recognition

Run:

```bash
sudo python3 face_recognizer.py
```

- May require `sudo` for GPIO access.
- Recognizes faces in real-time.
- If a known face is detected in **3 consecutive frames**, it toggles GPIO pin **HIGH for 3 seconds**.
- Then waits **5 seconds** before allowing another unlock.
- Press `q` to quit.

---

- May require `sudo` for GPIO access.
- Recognizes faces in real-time.
- If a known face is detected in **3 consecutive frames**, it toggles GPIO pin **HIGH for 3 seconds**.
- Then waits **5 seconds** before allowing another unlock.
- Press `q` to quit.

---

### ‚úÖ Alternative: Run with Options

Run:

```bash
python3 run.py
```
- Choose an option:
  - Create dataset, train model, and run face recognizer.
  - Run face recognizer.
---

## üîå GPIO Setup

### Default Pin

```python
GPIO_PIN = 17
```

Modify this in `face_recognizer.py` if needed.

### Wiring

#### LED Example:
- Connect **GPIO17 ‚Üí 220Œ© Resistor ‚Üí LED Anode (long leg)**  
- Connect **LED Cathode ‚Üí GND**

#### Relay Module Example:
- **Signal ‚Üí GPIO pin**  
- **VCC ‚Üí 3.3V or 5V (per your module)**  
- **GND ‚Üí GND**

---

## ‚öôÔ∏è Customization

You can modify the following values in `face_recognizer.py`:

| Parameter               | Default | Description |
|------------------------|---------|-------------|
| `RECOGNITION_THRESHOLD`| `3`     | Frames a face must be recognized to trigger unlock |
| `confidence < 85`      | `85`    | Recognition confidence level (lower = stricter) |
| `time.sleep(3)`        | `3`     | Unlock duration in seconds |
| `current_time - last_unlock_time > 5` | `5` | Cooldown between unlocks |

---

## üìÑ License

This project is open-source. Feel free to modify and adapt it for your use case.

